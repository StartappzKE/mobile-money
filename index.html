<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Mobile Money API</title>

        <link rel="stylesheet" href="mobile-money.dervisgroup.com/css/bootstrap.min.css">
        <link rel="stylesheet" href="mobile-money.dervisgroup.com/css/font-awesome.min.css">
        <link rel="stylesheet" href="mobile-money.dervisgroup.com/css/highlight.dark.css">
        <link rel="stylesheet" href="mobile-money.dervisgroup.com/css/main.css">
    </head>
    <body>

        <header class="navbar navbar-default navbar-fixed-top">

            <a class="navbar-brand" href="mobile-money.dervisgroup.com/">
                Mobile Money API
                <small class="hidden-xs hidden-sm">
                    This is the default subtitle!
                </small>
            </a>

            
        </header>

        <main class="container-fluid">
            <div class="row">

                
                    <nav id="sidebar" class="col-sm-3 col-lg-2" role="navigation">

                        <ul class="nav nav-pills nav-stacked">
                                                            <li class="">
                                    <a href="mobile-money.dervisgroup.com/">
                                        
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="mobile-money.dervisgroup.com/">
                                        
                                    </a>
                                </li>
                                                    </ul>

                    </nav>

                
                <section id="content" class="col-sm-offset-3 col-lg-offset-2 col-sm-9 col-lg-10">
                    <h1 id="mobile-money-payments-api">Mobile Money Payments API</h1>
<p><a href="https://packagist.org/packages/dervisgroup/mobile-money"><img src="https://img.shields.io/packagist/v/dervisgroup/mobile-money.svg?style=flat-square" alt="Latest Version on Packagist" /></a>
<a href="LICENSE.md"><img src="https://img.shields.io/badge/license-MIT-brightgreen.svg?style=flat-square" alt="Software License" /></a>
<a href="https://travis-ci.org/dervisgroup/mobile-money"><img src="https://img.shields.io/travis/dervisgroup/mobile-money/master.svg?style=flat-square" alt="Build Status" /></a>
<a href="https://scrutinizer-ci.com/g/dervisgroup/mobile-money/code-structure"><img src="https://img.shields.io/scrutinizer/coverage/g/dervisgroup/mobile-money.svg?style=flat-square" alt="Coverage Status" /></a>
<a href="https://scrutinizer-ci.com/g/dervisgroup/mobile-money"><img src="https://img.shields.io/scrutinizer/g/dervisgroup/mobile-money.svg?style=flat-square" alt="Quality Score" /></a>
<a href="https://styleci.io/repos/122853134"><img src="https://styleci.io/repos/122853134/shield?branch=master" alt="Style CI" /></a>
<a href="https://circleci.com/gh/dervisgroup/mobile-money"><img src="https://circleci.com/gh/dervisgroup/mobile-money.png?style=shield" alt="Circle CI" /></a>
<a href="https://packagist.org/packages/dervisgroup/mobile-money"><img src="https://img.shields.io/packagist/dt/dervisgroup/mobile-money.svg?style=flat-square" alt="Total Downloads" /></a></p>
<p><strong>Kenya</strong> Mobile Payments API</p>
<h2 id="about-dervis-group-limited">About Dervis Group Limited</h2>
<p><a href="https://dervisgroup.com">Dervis Group LLC</a> is a consultation and software providing company in Kenya dedicated to provide robust and fully functional sophisticated software solutions. Our main area of expertise is software development. We have also brought many stakeholders in board to offer solutions for mobile, cloud, Business Intelligence and  Technology Infrastructure. We focus on delivering true, measurable business value to our clients. We have a passion for customer satisfaction and are dedicated to delivering dependable and reliable solutions that exceed client expectations.</p>
<h2 id="introduction">Introduction</h2>
<p>This is a <em>Laravel 5.5+</em> package for mobile-money and Equity API.
The API allows a merchant to initiate C2B,B2C and B2B transactions including balance query and reversals.</p>
<p>This package includes Controllers, Migrations and Routes which simplifies everything for you.
You only need to setup a few things in the published configuration file and you are good to go.
It comes with a admin section to monitor transactions, send money via b2c and reverse transactions.</p>
<h2 id="installation">Installation</h2>
<p>Via Composer</p>
<pre><code class="language-bash">$ composer require dervisgroup/mobile-money</code></pre>
<h2 id="usage">Usage</h2>
<p>This package does not require you to register any service providers or aliases.</p>
<p>First, publish configuration files</p>
<pre><code class="language-bash">php artisan vendor:publish --provider="DervisGroup\Pesa\PesaServiceProvider"</code></pre>
<p>This will publish the M-mobile-money configuration file into the <code>config</code> directory as
<code>pesa.php</code>.
This file contains all the configurations required to use the package. </p>
<p>Go to <a href="https://developer.safaricom.co.ke">Safaricom Developer Portal</a> to get app credentials.</p>
<h3 id="mpesa">Mpesa</h3>
<p><em>STK PUSH REQUEST</em></p>
<p>Sim Toolkit Request is where you initiate a payment request, the request is then pushed to users phone to validate the transaction by entering their MPESA PIN .</p>
<p><code>mpesa_request('07xxxxxxxx',1,'reference','description')</code></p>
<blockquote>
<p>MPESA recently allowed transactions of even KES 1.00</p>
</blockquote>
<p>This package emits <code>DervisGroup\Pesa\Events\StkPushPaymentSuccessEvent</code> if an STK payment was processed successfully.
If an STK request payment is unsuccessful, it emits <code>DervisGroup\Pesa\Events\StkPushPaymentFailedEvent</code>. Both events exposes the initial request model to the registered event handlers.</p>
<p>A nice and efficient way to tap this events is to register a event listener in your EventServiceProvider</p>
<pre><code>&lt;?php

namespace Dervis\Providers;

use DervisGroup\Pesa\Events\C2bConfirmationEvent;
use DervisGroup\Pesa\Events\StkPushPaymentFailedEvent;
use DervisGroup\Pesa\Events\StkPushPaymentSuccessEvent;
use Illuminate\Foundation\Support\Providers\EventServiceProvider as ServiceProvider;

class EventServiceProvider extends ServiceProvider
{
    /**
     * The event listener mappings for the application.
     *
     * @var array
     */
    protected $listen = [
        C2bConfirmationEvent::class =&gt; [
            PaymentConfirmed::class,
        ],
        StkPushPaymentFailedEvent::class =&gt; [
            StkPaymentFailed::class,
        ],
        StkPushPaymentSuccessEvent::class =&gt; [
            StkPaymentReceived::class,
        ],
    ];
}
</code></pre>
<p><em>C2B Confirmation</em></p>
<p>The C2B Confirmation is sent to registered URL's above,
This confirmation is sent for both STK Push payment and User Initiated Payment <em>(Normal paybill number &gt; Account NUmber &gt; Amount &gt; PIN or Till Number &gt; Amount  &gt; PIN)</em></p>
<p>You can get the payment payload in the event handler like above ...</p>
<p>More documentation is in progress.</p>
<p>Need help integrating?  Mpesa, Equitel, RTGS, SWIFT, VISA, MASTERRCARD? Contact support below</p>
<h3 id="register-c2b-callback-url">Register C2B Callback Url</h3>
<blockquote>
<p>Note: Please use https. You will get weird errors if use non secure URL's for callback</p>
</blockquote>
<p>If you have setup <code>env('APP_URL)</code> in your <code>.env</code> you can used predefined endpoints in your published config file.
There are routes already registered to handle the incoming request.</p>
<pre><code class="language-bash">php artisan mpesa:register_url</code></pre>
<p>This will prompt you for the endpoints and send the for registration</p>
<h2 id="testing">Testing</h2>
<pre><code class="language-bash">$ composer test</code></pre>
<h2 id="security">Security</h2>
<p>If you discover any security related issues, please email sam@dervisgroup.com instead of using the issue tracker.</p>
<h2 id="support">Support</h2>
<ul>
<li><a href="https://github.com/dervisgroup">Samuel Dervis <a href="mailto:sam@dervisgroup.com">sam@dervisgroup.com</a></a></li>
</ul>
<h2 id="license">License</h2>
<p>The MIT License (MIT). Please see <a href="license.html">License File</a> for more information.</p>
                </section>

            </div>
        </main>

        <footer>
            <div class="container-fluid">
                <p class="text-muted">
                    website generated with <a href="http://couscous.io" title="Markdown website generator">Couscous</a>
                </p>
            </div>
        </footer>

        <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script src="//yastatic.net/highlightjs/8.2/highlight.min.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');
                // Syntax highlighting
                hljs.initHighlightingOnLoad();
            });
        </script>

    </body>
</html>
